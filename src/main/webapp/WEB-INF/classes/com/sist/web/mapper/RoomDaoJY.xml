<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.sist.web.dao.RoomDaoJY">
  
  <resultMap id="roomResultMap" type="com.sist.web.model.Room">
      <id column="ROOM_SEQ" property="roomSeq" />
      <result column="ROOM_CAT_SEQ" property="roomCatSeq" />
      <result column="HOST_ID" property="hostId" />
      <result column="ROOM_ADDR" property="roomAddr" />
      <result column="LATITUDE" property="latitude" />
      <result column="LONGITUDE" property="longitude" />
      <result column="REGION" property="region" />
      <result column="AUTO_CONFIRM_YN" property="autoConfirmYn" />
      <result column="ROOM_TITLE" property="roomTitle" />
      <result column="ROOM_DESC" property="roomDesc" />
      <result column="CANCEL_POLICY" property="cancelPolicy" />
      <result column="MIN_TIMES" property="minTimes" />
      <result column="MAX_TIMES" property="maxTimes" />
      <result column="AVERAGE_RATING" property="averageRating" />
      <result column="REVIEW_COUNT" property="reviewCount" />
      <result column="REG_DT" property="regDt" />
      <result column="UPDATE_DT" property="updateDt" />
      <result column="ROOM_TYPE_SEQ" property="roomTypeSeq" />
  </resultMap>
  
  <resultMap id="roomImgResultMap" type="com.sist.web.model.RoomImage">
		<id column="ROOM_IMG_SEQ" property="roomImgSeq" />
		<result column="ROOM_SEQ" property="roomSeq" />
		<result column="ROOM_IMG_ORIG_NAME" property="roomImgOrigName" />
		<result column="ROOM_IMG_EXT" property="roomImgExt" />
		<result column="IMG_SIZE" property="imgSize" />
		<result column="IMG_TYPE" property="imgType" />
		<result column="SORT_ORDER" property="sortOrder" />
		<result column="ROOM_IMG_NAME" property="roomImgName" />
		<result column="REG_DT" property="regDt" />
  </resultMap>
  
  <resultMap type="com.sist.web.model.RoomType" id="roomTypeResultMap">
  		<id column="ROOM_TYPE_SEQ" property="roomTypeSeq" />
  		<result column="ROOM_SEQ" property="roomSeq" />
  		<result column="ROOM_TYPE_TITLE" property="roomTypeTitle" />
  		<result column="ROOM_TYPE_DESC" property="roomTypeDesc" />
  		<result column="WEEKDAY_AMT" property="weekdayAmt" />
  		<result column="WEEKEND_AMT" property="weekendAmt" />
  		<result column="ROOM_CHECK_IN_DT" property="roomCheckInDt" />
  		<result column="ROOM_CHECK_OUT_DT" property="roomCheckOutDt" />
  		<result column="ROOM_CHECK_IN_TIME" property="roomCheckInTime" />
  		<result column="ROOM_CHECK_OUT_TIME" property="roomCheckOutTime" />
  		<result column="MAX_GUESTS" property="maxGuests" />
  		<result column="MIN_DAY" property="minDay" />
  		<result column="MAX_DAY" property="maxDay" />
  		<result column="REG_DT" property="regDt" />
  		<result column="UPDATE_DT" property="updateDt" />
  		<result column="HOST_ID" property="hostId" />
  </resultMap>
  
	<select id="getRoomDetail" resultMap="roomResultMap" parameterType="int">
	    SELECT ROOM_SEQ, 
	           ROOM_CAT_SEQ, 
	           HOST_ID, 
	           ROOM_ADDR, 
	           LATITUDE, 
	           LONGITUDE, 
	           REGION, 
	           AUTO_CONFIRM_YN, 
	           ROOM_TITLE, 
	           ROOM_DESC, 
	           CANCEL_POLICY, 
	           MIN_TIMES, 
	           MAX_TIMES, 
	           AVERAGE_RATING, 
	           REVIEW_COUNT, 
	           TO_CHAR(REG_DT, 'YY/MM/DD') AS REG_DT, 
	           TO_CHAR(UPDATE_DT, 'YY/MM/DD') AS UPDATE_DT
	    FROM ROOM
	    WHERE ROOM_SEQ = #{roomSeq}
	</select>

	<select id="getRoomTypesByRoomSeq" parameterType="int" resultMap="roomTypeResultMap"> 
		SELECT ROOM_TYPE_SEQ, 
			   ROOM_SEQ, 
			   ROOM_TYPE_TITLE, 
			   ROOM_TYPE_DESC, 
			   WEEKDAY_AMT, 
			   WEEKEND_AMT, 
			   ROOM_CHECK_IN_DT, 
			   ROOM_CHECK_OUT_DT, 
			   TO_CHAR(CHECK_IN_TIME, 'HH24:MI') AS CHECK_IN_TIME, 
			   TO_CHAR(CHECK_OUT_TIME, 'HH24:MI') AS CHECK_OUT_TIME, 
			   MAX_GUESTS, MIN_DAY, 
			   MAX_DAY, 
			   REG_DT, 
			   UPDATE_DT, 
			   HOST_ID 
		  FROM ROOM_TYPE 
		 WHERE ROOM_SEQ = #{roomSeq} 
	</select>


	<select id="getRoomImgDetail" resultMap="roomImgResultMap" parameterType="int">
		SELECT 
		    ROOM_IMG_SEQ, 
		    ROOM_SEQ, 
		    ROOM_IMG_ORIG_NAME, 
		    ROOM_IMG_EXT, 
		    IMG_SIZE, 
		    IMG_TYPE, 
		    SORT_ORDER, 
		    ROOM_IMG_NAME,
		    TO_CHAR(REG_DT, 'YY/MM/DD') AS REG_DT
		FROM ROOM_IMAGE
		WHERE ROOM_SEQ = #{roomSeq}
	</select>
  
	<select id="getRoomImagesByRoomSeq" parameterType="int" resultType="com.sist.web.model.RoomImage">
		SELECT 
			ROOM_IMG_SEQ, 
			ROOM_SEQ, 
			ROOM_IMG_ORIG_NAME, 
			ROOM_IMG_EXT, 
			IMG_SIZE, IMG_TYPE, 
			SORT_ORDER, ROOM_IMG_NAME
		FROM ROOM_IMAGE
		WHERE ROOM_SEQ = #{roomSeq}
		ORDER BY SORT_ORDER ASC
	</select>	
	
	<select id="selectHostIdByRoomSeq" parameterType="int" resultType="String">
	    SELECT HOST_ID 
	    FROM ROOM 
	    WHERE ROOM_SEQ = #{roomSeq}
	</select>
	
</mapper>



